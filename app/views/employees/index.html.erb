<div class="employee_index container mt-5">
  <h1 class="text-center">社員一覧</h1>
  <% if flash.notice.present? %>
    <div class="alert alert-success" role="alert">
      <%= flash.notice %>
    </div>
  <% end %>
  <% if current_user.employee_info_manage_auth %>
    <div class="d-flex justify-content-end mb-3">
      <p class="new_employee"><%= link_to "新規追加", new_employee_path, class: "btn btn-primary" %></p>
    </div>
  <% end %>
  <table class="table table-hover employee_table text-center">
    <thead>
      <tr>
        <th><%= sort_order "number", "社員番号" %></th>
        <th class="name">氏名</th>
        <th class="department_th"><%= sort_order "department_id", "所属" %></th>
        <% if current_user.employee_info_manage_auth %>
          <th></th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @employees.each do |employee| %>
        <tr class="employee">
          <% if employee.profiles.active.present? %>
            <% if employee == current_user %>
              <td><%= link_to employee.number, edit_employee_profile_path(employee, employee.profiles.active.first) %></td>
            <% else %>
              <td><%= link_to employee.number, employee_profile_path(employee, employee.profiles.active.first) %></td>
            <% end %>
          <% else %>
            <td><%= link_to employee.number, employee_profiles_path(employee) %></td>
          <% end %>
          <td class="name"><%= "#{employee.last_name} #{employee.first_name}" %></td>
          <td><%= employee.department.name %></td>
          <% if current_user.employee_info_manage_auth %>
            <td>
            <%= link_to "編集", edit_employee_path(employee), class: "btn btn-secondary" %>
            <%= link_to "削除", employee, method: :delete, data: { confirm: "社員「#{employee.first_name} #{employee.last_name}」を削除します。よろしいですか？" }, class: "btn btn-danger" %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
